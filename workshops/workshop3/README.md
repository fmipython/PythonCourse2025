# Workshop 3 - REST API with Flask and FastAPI

## Накратко

* REST API
* CRUD операции с база данни
* Authentication
* Flask vs FastAPI
* Тестове

## Какво ви е дадено

* [db.py](db.py) и [db_models.py](db_models.py) - Модели и операции с SQLite база данни
* [flask_app.py](flask_app.py) и [fastapi_app.py](fastapi_app.py) - Започнати JSON REST API чрез Flask и FastAPI съответно.
* [flast_tests.py](flask_tests.py) и [fastapi_tests.py](fastapi_tests.py) - API тестове

## Какво се изисква от вас?

Имплементирани са само endpoint-и за **потребители**. Трябва да довършите с такива за **публикации**:
* `POST /publications/` - Създаване на публикация (само за автентикирани потребители)
  * 401 при липса на правилна автентикация
  * 400 при липсващи полета/тяло на заявката
  * 201 при успешно създаване (и да се върне създадената публикация)
* `GET /publications/{publication_id}/` - Връщане на публикация по ID
  * 404 ако публикацията не съществува
  * 200 при успешно връщане на публикацията
* `GET /publications/` - Връщане на списък с всички
  * параметър `skip` (по подразбиране 0) - брой публикации за пропускане
  * параметър `limit` (по подразбиране 100) - максимален брой публикации за връщане
  * параметър `owner_id` (по избор) - филтриране по собственик
* `PUT /publications/{publication_id}/` - Актуализиране на публикация (само от собственика или администратор)
  * 401 при липса на автентикация
  * 404 ако публикацията не съществува
  * 403 при опит за достъп от друг потребител, който няма право
  * 400 при липсващи полета/тяло на заявката
  * 200 при успешно актуализиране (и да се върне актуализираната публикация)
* `DELETE /publications/{publication_id}/` - Изтриване на публикация (само от собственика или администратор)
  * 401 при липса на автентикация
  * 404 ако публикацията не съществува
  * 403 при опит за достъп от друг потребител, който няма право
  * 200 при успешно изтриване (и да се върне съобщение за успех)

Напишете подходящи тестове за всички изброени случаи. Може да подходите по test-driven подход (първо пишете тестовете, след това кода) или да довършите първо кода и после да напишете тестовете - по ваш избор. Ако сметнете, че нямаше много време, напишете само по един тест на ендпойнт, поне за начало.

## Особености

* За автентикация използвайте вече наличния код (Basic Auth). Не е нужно да имплементирате нова система. За вашите проекти е пропоръчително да разучите по-сигурен начин на автентикация (напр. OAuth2, JWT и т.н.)
* За улеснение имате направени декоратори и помощни сериализиращи функции (за flask app), както и Pydantic модели и Depends функции (за FastAPI app)
* Обърнете внимание, че при първото пускане на сървърите се създават таблиците в базата данни и се добавя един хардкоднат администраторски потребител, с който можете да си тествате (име `test_admin`, парола `testing123`)
* Разгледайте съществуващите ендпойнти, както и методите на `DatabaseService`, преди да започнете работа

## Полезни ресурси

- [Flask Documentation](https://flask.palletsprojects.com/)
- [FastAPI Documentation](https://fastapi.tiangolo.com/)
- [Postman](https://www.postman.com/) - Инструмент за правене на заявки към API
- [Postman VSCode extension](https://marketplace.visualstudio.com/items?itemName=Postman.postman-for-vscode)
- [DB viewer VSCode extension](https://marketplace.visualstudio.com/items?itemName=MJStudio.db-viewer)
- [Pytest Documentation](https://docs.pytest.org/)
- [Pydantic Documentation](https://docs.pydantic.dev/)

